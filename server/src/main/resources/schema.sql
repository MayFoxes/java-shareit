CREATE TABLE IF NOT EXISTS USERS (
  ID    BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  NAME  VARCHAR(255),
  EMAIL VARCHAR(512),
  CONSTRAINT PK_USER PRIMARY KEY (ID),
  CONSTRAINT UQ_USER_EMAIL UNIQUE (EMAIL)
);

CREATE TABLE IF NOT EXISTS REQUESTS (
    ID          BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    DESCRIPTION VARCHAR(255),
    CREATED     TIMESTAMP,
    USER_ID     BIGINT REFERENCES USERS (ID),
    CONSTRAINT PK_REQUESTS PRIMARY KEY (ID)
);

CREATE TABLE IF NOT EXISTS ITEMS (
  ID            BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  NAME          VARCHAR(255),
  DESCRIPTION   VARCHAR(255),
  AVAILABLE     BOOLEAN,
  OWNER_ID      BIGINT REFERENCES USERS (ID) ON DELETE CASCADE,
  REQUEST_ID    BIGINT REFERENCES REQUESTS (ID) ON DELETE CASCADE,
  CONSTRAINT PK_ITEM PRIMARY KEY (ID)
);

CREATE TABLE IF NOT EXISTS BOOKINGS (
  ID            BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  START_TIME    TIMESTAMP,
  END_TIME      TIMESTAMP,
  ITEM_ID       BIGINT REFERENCES ITEMS (ID),
  BOOKER_ID     BIGINT REFERENCES USERS (ID),
  STATUS        VARCHAR(10),
  CONSTRAINT PK_BOOKING PRIMARY KEY (ID)
);

CREATE TABLE IF NOT EXISTS COMMENTS (
    ID          BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    COMMENT     VARCHAR(2000),
    ITEM_ID     BIGINT REFERENCES ITEMS (ID),
    USER_ID     BIGINT REFERENCES USERS (ID),
    AUTHOR_NAME VARCHAR(100),
    CREATED     TIMESTAMP,
    CONSTRAINT PK_COMMENTS PRIMARY KEY (ID)
);